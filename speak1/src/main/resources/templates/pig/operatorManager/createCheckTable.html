<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta charset="UTF-8">
  <title></title>

  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
  <meta http-equiv="description" content="This is my page">
  <link href="../images/skin.css" rel="stylesheet" type="text/css" />
  <style type="text/css">
    body {
      margin-left: 0px;
      margin-top: 0px;
      margin-right: 0px;
      margin-bottom: 0px;
      background-color: #EEF2FB;
    }
  </style>

</head>

<body>
<form action="#" method="post">
  <h5><font color="red"></font></h5>
  <input type="hidden" name="method" value="createCheckTable"/>
  <input type="hidden" name="tableid" value="${requestScope.rent.tableid }"/>
  <table width="100%" border="0" cellpadding="0" cellspacing="0">
    <tr>
      <td width="17" valign="top" background="../images/mail_leftbg.gif"><img src="../images/left-top-right.gif" width="17" height="29" /></td>
      <td valign="top" background="../images/content-bg.gif"><table width="100%" height="31" border="0" cellpadding="0" cellspacing="0" class="left_topbg" id="table2">
        <tr>
          <td height="31"><div class="titlebt">汽车入库</div></td>
        </tr>
      </table></td>
      <td width="16" valign="top" background="../images/mail_rightbg.gif"><img src="../images/nav-right-bg.gif" width="16" height="29" /></td>
    </tr>
    <tr>
      <td valign="middle" background="../images/mail_leftbg.gif">&nbsp;</td>
      <td valign="top" bgcolor="#F7F8F9"><table width="98%" border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td colspan="2" valign="top">&nbsp;</td>
          <td>&nbsp;</td>
          <td valign="top">&nbsp;</td>
        </tr>
        <tr>
          <td colspan="2" valign="top"><span class="left_bt">
	<table class="maintable" width="100%" border="0" cellspacing="0">
	<tr>
		<td width="12%" height="27">
	    <div align="center" class="left_txt">检查单号：</div></td>
		<td width="13%"><input type="text" name="checkid" id="checkId" value="" readonly="readonly"></td>
		<td width="14%">&nbsp;</td>
		<td width="14%">&nbsp;</td>
		<td width="20%">
		  <div align="center" class="left_txt">检查时间：</div></td>
		<td width="27%"><input type="text" name="checkdate" id="checkDate" value="" readonly="readonly"></td>
	</tr>
	<tr>
		<td width="12%" height="27">
	    <div align="center" class="left_txt">检查员：</div>		</td>
		<td width="13%"><input type="text" name="checkUserId" id="checkUserId" value="" readonly></td>
		<td width="14%">&nbsp;</td>
		<td width="14%">&nbsp;</td>
		<td width="20%">
		  <div align="center" class="left_txt">属性：</div></td>
		<td width="27%"><input type="text" name="field" id="field" ></td>
	</tr>
	<tr>
		<td width="12%" height="27">
	    <div align="center" class="left_txt">问题：</div>		</td>
		<td width="13%"><input type="text" name="problem" id="problem" ></td>
		<td width="14%">&nbsp;</td>
		<td width="14%">&nbsp;</td>
		<td width="20%">
		  <div align="center" class="left_txt">赔费：</div></td>
		<td width="27%"><input type="text" oninput="value=value.replace(/[^\d]/g,'')"  name="paying" id="paying" ></td>
	</tr>
	<tr>
		<td colspan="6" align="center" id="cz">
		<
		</td>
	</tr>

	<tr>
		<td colspan="6">
		<hr color="#99CCFF">		</td>
	</tr>
	 <tr align="center" bgcolor="#EEF2FB">
		<td height="19" colspan="6" class="titleLine" bgcolor="#EEF2FB">
		<div align="left">
		  <p>&nbsp;</p>
		  <p>&nbsp;</p>
		</div>		</td>
	</tr>
	<tr>
		<td colspan="6">
		<hr color="#99CCFF">		</td>
	</tr>
	<tr>
		<td height="23" colspan="6" align="center">
	  <div align="center" class="left_txt">出租单信息</div>		</td>
	</tr>
	<tr>
		<td colspan="6">
		<hr color="#99CCFF">		</td>
	</tr>
	<tr>
      <td><div align="center" class="left_txt">出租单编号：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="tableid"></font></div></td>
	  <td><div align="center" class="left_txt">预付金：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="imprest"></font></div></td>
	  <td><div align="center" class="left_txt">应付金：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="shouldpayprice"></font></div></td>
    </tr>
	<tr>
		<td colspan="6">
		<hr color="#99CCFF"></td>
	</tr>
	<tr>
      <td><div align="center" class="left_txt">实际交付金额：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="price"></font></div></td>
	  <td><div align="center" class="left_txt">起租日期：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="begindate"></font></div></td>
	  <td><div align="center" class="left_txt">应归还日期：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="shouldreturndate"></font></div></td>
    </tr>
	<tr>
		<td colspan="6">
		<hr color="#99CCFF">		</td>
	</tr>
	<tr>
      <td><div align="center" class="left_txt">归还日期：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="returndate">

	  	</font>
	  </div></td>
	  <td><div align="center" class="left_txt">出租单状态：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="rentflag">

		  	</font>
	  </div></td>
	  <td><div align="center" class="left_txt">服务人员编号：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="rentUsername"></font></div></td>
    </tr>
	<tr>
		<td colspan="6">
		<hr color="#99CCFF"></td>
	</tr>

	<tr align="center" bgcolor="#EEF2FB">
		<td height="19" colspan="6" class="titleLine" bgcolor="#EEF2FB">
		<div align="left">
		  <p>&nbsp;</p>
		  <p>&nbsp;</p>
		</div>		</td>
	</tr>
	<tr>
      <td colspan="6"><hr color="#99CCFF">      </td>
    </tr>
	<tr>
      <td height="23" colspan="6"><div align="center" class="left_txt">客户信息</div></td>
    </tr>
	<tr>
      <td colspan="6"><hr color="#99CCFF">      </td>
    </tr>
	<tr>
      <td><div align="center" class="left_txt">身份证：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="identity"></font></div></td>
	  <td><div align="center" class="left_txt">姓名：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="custname"></font></div></td>
	  <td><div align="center" class="left_txt">性别：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="sex"></font></div></td>
    </tr>
	<tr>
      <td colspan="6"><hr color="#99CCFF">      </td>
    </tr>
	<tr>
      <td><div align="center" class="left_txt">地址：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="address"></font></div></td>
	  <td><div align="center" class="left_txt">电话：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="phone"></font></div></td>
	  <td><div align="center" class="left_txt">职业：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="career"></font></div></td>
    </tr>
	<tr>
      <td colspan="6"><hr color="#99CCFF">      </td>
    </tr>
     <tr align="center" bgcolor="#EEF2FB">
		<td height="19" colspan="6" class="titleLine" bgcolor="#EEF2FB">
		<div align="left">
		  <p>&nbsp;</p>
		  <p>&nbsp;</p>
		</div>		</td>
	</tr>
	<tr>
      <td colspan="6"><hr color="#99CCFF">      </td>
    </tr>
	<tr>
     <td height="23" colspan="6"><div align="center" class="left_txt">车信息</div></td>

    </tr>
    <tr>
      <td colspan="6"><hr color="#99CCFF">      </td>
    </tr>
    <tr>
      <td><div align="center" class="left_txt">车号：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="carNumber"></font></div></td>
	  <td><div align="center" class="left_txt">型号：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="carType"></font></div></td>
	  <td><div align="center" class="left_txt">颜色：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="color"></font></div></td>
    </tr>
    <tr>
      <td colspan="6"><hr color="#99CCFF">      </td>
    </tr>
    <tr>
      <td><div align="center" class="left_txt">价值：</div></td>
	  <td><div align="center" class="left_txt"> <font color="red" id="carsPrice"> </font></div></td>
	  <td><div align="center" class="left_txt">租金：</div></td>
	  <td><div align="center" class="left_txt"> <font color="red" id="rentPrice"> </font></div></td>
	  <td><div align="center" class="left_txt">押金：</div></td>
	  <td><div align="center" class="left_txt"> <font color="red" id="deposit"> </font></div></td>
    </tr>
    <tr>
      <td colspan="6"><hr color="#99CCFF">      </td>
    </tr>
    <tr>
      <td><div align="center" class="left_txt">租用情况：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="isRenting">

	  </font>
	  </div></td>
	  <td><div align="center" class="left_txt">简介：</div></td>
	  <td><div align="center" class="left_txt"><font color="red" id="carDesc"></font></div></td>

    </tr>
    <tr>
		<td colspan="6">
		<hr color="#99CCFF"></td>
	</tr>
</table>
</body>
<script src="../js/jquery-1.9.1.js"></script>
<script>

	function subForm(){

		var checkId=$('#checkId').val();
		var checkDate=$('#checkDate').val();
		var checkUserId=$('#checkUserId').val();
		var field=$('#field').val();
		var problem=$('#problem').val();
		var paying=$('#paying').val();
		var tableid=$('#tableid').html()
		var carNumber=$('#carNumber').html()
		$.ajax({
			type:'get',
			url:"http://localhost:8080/main/addCheck",
			dataType:"json",
			crossDomain:true,
			data:{'checkid':checkId,'checkdate':checkDate,'checkUserId':checkUserId,'field':field,'problem':problem,'carNumber':carNumber,'paying':paying,'tableid':tableid,'rentflag':1,'returndate':checkDate},
			xhrFields:{withCredentials:true},
			success:function (data) {
				if(data){
					alert('检查单已成功提交')
					location.href='checkManager.html'
				}
			}
		})
	}

	var loginUser=''
	$.ajax({
		type:"get",
		url:"http://localhost:8080/user/getUserlogin",
		dataType:"json",
		crossDomain:true,
		async: false,
		xhrFields:{withCredentials:true},
		success:function (result) {
			loginUser= result.user.username
		}
	})

	$.ajax({
		type:"get",
		url:"http://localhost:8080/main/getfindCheckTable",
		dataType:'json',
		crossDomain: true,
		xhrFields: {withCredentials: true},
		success:function (data) {
			console.log(data)
			var str='';
			str+=data.rent.rentflag!=1?'<img  src="../images/carimg/car.gif" onclick="subForm()">\n' +
					'\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;':''
			str+='<img  src="../images/carimg/return.gif" onclick="history.back()">'
			$('#cz').html(str)

			$('#checkId').val(data.checkId)
			$('#checkDate').val(data.checkDate)
			$('#checkUserId').val(loginUser)
			$('#tableid').html(data.rent.tableid)
			$('#imprest').html(data.rent.imprest)
			$('#shouldpayprice').html(data.rent.shouldpayprice)
			$('#price').html(data.rent.price )
			$('#begindate').html(data.rent.begindate)
			$('#shouldreturndate').html(data.rent.shouldreturndate)
			$('#returndate').html(data.rent.returndate)
			$('#rentflag').html(data.rent.rentflag==1?'已入库/已生成检查单':'出租中')
			$('#rentUsername').html(data.rent.users.username)
			$('#identity').html(data.rent.customers.identity)
			$('#custname').html(data.rent.customers.custname)
			$('#sex').html(data.rent.customers.sex)
			$('#address').html(data.rent.customers.address)
			$('#phone').html(data.rent.customers.phone)
			$('#career').html(data.rent.customers.career)
			$('#carNumber').html(data.rent.cars.carNumber)
			$('#carType').html(data.rent.cars.carType)
			$('#color').html(data.rent.cars.color)
			$('#carsPrice').html(data.rent.cars.price)
			$('#rentPrice').html(data.rent.cars.rentPrice)
			$('#deposit').html(data.rent.cars.deposit)
			$('#isRenting').html(data.rent.cars.isRenting==1?'已出租':'未出租')
			$('#carDesc').html(data.rent.cars.carDesc)

		}

	})


</script>
</html>
